---
title: "batchQC Report"
author: "Mani"
date: "Saturday, March 07, 2015"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

You can also embed plots, for example:

```{r, echo=FALSE}
require(sva)
require(limma)
require("MCMCpack")
require("BatchQC")
nbatch <- 3
ncond <- 2
npercond <- 10
data.matrix <- rnaseq_sim(ngenes=50, nbatch=nbatch, ncond=ncond, npercond=npercond, 
                          ggstep=5, bbstep=15000, ccstep=10000, bvarstep=2, seed=1234)
pca <- batchQC(data.matrix, nbatch=nbatch, ncond=ncond, npercond=npercond)

### apply combat
batch <- rep(1:nbatch, each=ncond*npercond)
sample <- 1:nbatch*ncond*npercond
pdata <- data.frame(sample, batch)
modcombat = model.matrix(~1, data=pdata)  
combat_data.matrix = ComBat(dat=data.matrix, batch=batch, mod=modcombat)

### Rerun the pipeline on the batch adjusted data
pca <- batchQC(combat_data.matrix, nbatch=nbatch, ncond=ncond, npercond=npercond)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
