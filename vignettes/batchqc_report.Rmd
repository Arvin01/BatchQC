---
title: "batchQC Report"
author: "Mani"
date: "Saturday, March 07, 2015"
output: 
  html_document:
    toc: true
    toc_depth: 2
---
Synopsis
========

rmarkdown::render("batchqc_report.Rmd")

Description
===========

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

You can also embed plots, for example:

```{r, echo=FALSE, message=FALSE}
require(sva)
require(limma)
require("MCMCpack")
require("BatchQC")
nbatch <- 3
ncond <- 2
npercond <- 10
data.matrix <- rnaseq_sim(ngenes=50, nbatch=nbatch, ncond=ncond, npercond=npercond, 
                          ggstep=5, bbstep=15000, ccstep=10000, bvarstep=2, seed=1234)
batch <- rep(1:nbatch, each=ncond*npercond)
condition <- rep(rep(1:ncond, each=npercond), nbatch)
nsample <- nbatch*ncond*npercond
sample <- 1:nsample
pdata <- data.frame(sample, batch, condition)
modmatrix = model.matrix(~as.factor(condition), data=pdata)  

pca <- batchQC(data.matrix, batch=batch, mod=modmatrix)

### apply combat
combat_data.matrix = ComBat(dat=data.matrix, batch=batch, mod=modmatrix)

### Rerun the pipeline on the batch adjusted data
pca <- batchQC(combat_data.matrix, batch=batch, mod=modmatrix)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
